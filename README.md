# mcv_l1_2023
# Лабораторная работа №1
## Вариант 4

## Теоритическая база

Chroma key (цветовой ключ) — это технология, используемая для отделения человека, предмета или другого объекта от фонового изображения или видео с целью последующего наложения его на другой фон. В основе технологии лежит использование однотонного цвета для выделения объекта съемки и последующего его отделения от исходного фона.

Процесс использования Chroma key состоит из нескольких этапов:

Подготовка к съемке: выбор однотонного цвета, который будет использоваться в качестве ключевого цвета. Наиболее часто используются зеленый, синий и голубой цвета, так как они наименее распространены в одежде и интерьере и легко отделяются от большинства других цветов.

Съемка: объект съемки располагается на однотонном фоне выбранного цвета. Фон должен быть однородным и не иметь резких цветовых переходов, чтобы обеспечить четкое отделение объекта от фона.

Обработка изображения: после съемки видео или изображения обрабатываются с использованием специального программного обеспечения, которое выделяет все пиксели ключевого цвета и заменяет их на новый фон.

## Описание разработанной системы

Алгоритм работы системы
1. Открываем видеопоток.
2. Пока есть кадры в видео.
   1. Читаем кадры в переменную frame.
   2. Находим пиксели, цвет которых находится в заданном диапазоне цвета.
   3. Убираем в исходном кадре пиксели, которые попали в диапазон.
   4. В получившемся кадре заменяем нулевые пиксели на пиксели заданной картинки, сохраняя положение пикселей.
   5. Выводим на экран.

## Результаты работы и тестирования системы

Логи вывода системы

```
OpenCV + NumPy
OpenCV + NumPy (1 attempt): 21451.758592000002 μs per frame / FPS: 46.61622475897756
OpenCV + NumPy (2 attempt): 20599.31136 μs per frame / FPS: 48.54531214775522
OpenCV + NumPy (3 attempt): 20599.037952 μs per frame / FPS: 48.54595648254088
OpenCV + NumPy (4 attempt): 20027.74016 μs per frame / FPS: 49.9307456563287
OpenCV + NumPy (5 attempt): 21179.46368 μs per frame / FPS: 47.21554875557642
OpenCV + NumPy * 5 times: 20771.4623488 μs per frame;
OpenCV + NumPy Mean FPS: 48.14297535761952

NumPy
NumPy (1 attempt): 162803.661824 μs per frame / FPS: 6.142367983596442
NumPy (2 attempt): 166892.488704 μs per frame / FPS: 5.991881406799541
NumPy (3 attempt): 165349.379072 μs per frame / FPS: 6.047800152697025
NumPy (4 attempt): 164498.7904 μs per frame / FPS: 6.079072056204008
NumPy (5 attempt): 165338.284032 μs per frame / FPS: 6.0482059908548305
NumPy * 5 times: 164976.52080640002 μs per frame;
NumPy Mean FPS: 6.061468596331355
```

Результат работы OpenCV

![output.gif](./output1.gif)


Результат работы NumPy

![output2.gif](./output2.gif)

## Выводы по работе

В процессе выполнения данной работы были исследованы варианты реализации chroma key в Python при помощи OpenCV и при помощи NumPy. В результате получены средние значения для обработки одного кадра в обоих вариантах. В варианте с использованием OpenCV время обработки одного кадра составило примерно 20 мс, с использованием NumPy - 165 мс. Вариант без использования NumPy и OpenCV решено было не реализовывать, т.к. время обработки кадра составляло около 5с.
  
## Использованные источники

1. https://hadrien-montanelli.github.io/2022-12-30.html
2. https://en.wikipedia.org/wiki/Chroma_key
3. https://www.researchgate.net/publication/2337014_Software_Chroma_Keying_in_an_Immersive_Virtual_Environment
